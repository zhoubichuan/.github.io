---
title: vuex使用
copyright: true
permalink: 1
top: 0
date: 2019-05-12 10:21:32
categories:
- 前端开发
- 基础知识
- 框架
- vue
- 2.进阶
- 4.vuex的用法
tags:
- vue
- vuex
---

## 1.安装

```
npm install vuex
```

main.js 中

```
import store from './store/index'
new Vue({
  router,
  store,
  render: h => h(App)
}).$mount('#app')
```

## 2.新建 store

index.js

```
import Vue from'vue'
import vuex from 'vuex'
import actions from './actions'
import mutations from './mutations'
import state from './state'
import getters from './getters'
import user from './modules/user'

Vue.use(vuex)

export default new vuex.Store({
    modules:{
        user
    },
    // strict:process.env.NODE_ENV !=='production',
    actions,
    mutations,
    state,
    getters
})
```

state.js

```
export default{
    lesson:'vuex学习'
}
```

mutations.js

```
export default{

}
```

getters.js

```
export default{
    getNewName(state){
        return '高级'+state.lesson
    }
}
```

actions.js

```
export default{

}
```

modules/user.js

```
export default {
  namespaced: true,
  state: {
    userName: "我"
  },
  getters: {
      getNewUserName(state){
          return '是'+state.userName
      }
  },
  mutations: {
      chage_user(state,payload){
          state.userName=payload
      }
  },
  actions: {
      change_user({commit},payload){
          setTimeout(()=>{
              commit('change_user',payload)
              //在action中可以多次触发mutation
          },1000)
          setTimeout(()=>{
              commit('change_user','hello')
              //在action中可以多次触发mutation
          },2000)
      }
  }
};
```

## 3.使用

```
<template>
  <div id="app">
    {{lesson}}
    {{className}}
    {{u}}
    {{getNewName}}
    {{getNewUserName}}
    <button @click="change">修改状态</button>
  </div>
</template>

<script>
import { mapState, mapGetters, mapActions } from "vuex";
export default {
  name: "app",
  methods: {
    ...mapActions("user", ["change_user"]),
    change() {
      this.$store.state.user.userName = "hello world";
      this["change_user"]("jw");
      this.$store.commit("user/change_user", "jw");
      this.$store.dispatch("user/change_user", "jw");
    }
  },
  computed: {
    ...mapState(["lesson", "className"]),
    ...mapState("user", { u: s => s.userName }),
    ...mapGetters(["getNewName"]),
    ...mapGetters("user", ["getNewUserName"])
  }
};
</script>
```
